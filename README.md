# 🖼️ 图片加密分割 & 无损还原工具 (Visual Cryptography Tool)

[![Python](https://img.shields.io/badge/Python-3.8%2B-blue)](https://www.python.org/)
[![Flask](https://img.shields.io/badge/Flask-2.0%2B-green)](https://flask.palletsprojects.com/)
[![License](https://img.shields.io/badge/license-MIT-yellow)](LICENSE)

这是一个基于 Python Flask 和 Pillow (PIL) 开发的 Web 应用程序，实现了**视觉加密 (Visual Cryptography)** 的概念。

该工具可以将一张原始图片分割（加密）成多个看似杂乱无章的切片，只有将这些切片叠加在一起时，才能还原（解密）出原始图像。它非常适合用于演示图像处理算法、视觉混淆技术或作为趣味性的数据隐藏工具。

## ✨ 主要功能

### 🔐 图片分割 (加密)
将上传的图片通过算法分割成多个层（切片），支持多种分割模式以应对不同的混淆需求：

*   **🧱 块状模式 (Block Mode)**：推荐模式。将图片分成方块区域，每个方块整体分配给一个切片，单张切片难以识别内容。
*   **🧩 拼图模式 (Jigsaw Mode)**：将图片分割成较大的拼图块，更加离散。
*   **🔬 像素模式 (Pixel Mode)**：按单个像素随机分配，生成的切片像噪点图。
*   **📊 条纹模式 (Stripe Mode)**：按水平或垂直条纹进行“碎纸机”式分割。
*   **✨ 散点模式 (Scatter Mode)**：将像素分组后随机打散。
*   **📐 网格模式 (Grid Mode)**：均匀的网格分配。

**高级选项：**
*   **🔄 反色处理**：在分割前自动反转图片颜色，增加还原难度（还原时需再次反色）。
*   **🎛️ 参数自定义**：支持自定义切片数量（2-100）、块大小、背景颜色（黑/白）。
*   **🎲 噪声注入**：向切片的空白区域添加随机噪声，防止通过透明度轻易还原。
*   **🔢 随机种子**：支持固定随机种子，以便复现分割结果。

### 🔧 图片还原 (解密)
上传之前生成的切片文件，工具将尝试无损还原原图：

*   **无损叠加**：基于像素级的叠加逻辑，自动处理透明背景。
*   **自动尺寸适配**：自动统一不同尺寸的切片到基准尺寸。
*   **智能后处理**：
    *   **自动增强**：提供锐化（Unsharp Mask）和对比度调整功能，使还原的图片更清晰。
    *   **反色生成**：自动生成一张“反色版”还原图，以应对加密时开启了反色选项的情况。

## 🚀 快速开始

### 1. 环境要求
确保您的系统中已安装 Python 3.8 或更高版本。

### 2. 克隆项目
```bash
git clone https://github.com/your-username/image-splitter-tool.git
cd image-splitter-tool
```

### 3. 安装依赖
本项目主要依赖 Flask 和 Pillow。
```bash
pip install flask pillow
```

### 4. 运行应用
```bash
python app.py
```

### 5. 访问工具
打开浏览器并访问：
`http://127.0.0.1:5000`

## 📖 使用指南

### 第一步：分割加密
1.  点击 **"分割加密"** 标签页。
2.  拖拽或点击上传一张图片。
3.  在右侧选择 **分割模式**（例如：块状模式）。
4.  调整 **切片数量** 和 **块大小**。
5.  （可选）勾选 **"分割前反色处理"** 或增加 **噪声级别**。
6.  点击 **"开始分割加密"**。
7.  下载生成的切片图片，或点击 **"下载全部 (ZIP)"**。

### 第二步：无损还原
1.  点击 **"无损还原"** 标签页。
2.  同时选中并上传之前生成的**所有**切片文件。
3.  （可选）调整 **增强效果**、**锐化半径** 等参数优化画质。
4.  点击 **"开始还原"**。
5.  查看结果：
    *   `_原图.png`: 直接叠加的结果。
    *   `_反色.png`: 如果加密时开启了反色，请查看此图。
    *   `_增强.png`: 经过锐化和对比度调整的图片。

## 📂 项目结构

```text
.
├── app.py              # Flask 后端核心逻辑
├── static/
│   └── index.html      # 前端单页应用 (包含 JS/CSS)
├── uploads/            # 临时上传目录 (会自动清理)
└── outputs/            # 临时输出目录 (会自动清理)
```

## ⚙️ 配置说明

在 `app.py` 文件顶部，你可以修改以下全局配置：

```python
UPLOAD_FOLDER = 'uploads'        # 上传文件夹路径
OUTPUT_FOLDER = 'outputs'        # 输出文件夹路径
SESSION_LIFETIME_SECONDS = 3600  # 临时文件保留时间 (秒)
CLEANUP_INTERVAL_SECONDS = 1800  # 清理任务运行间隔 (秒)
```

## 🤝 贡献
欢迎提交 Pull Request 或 Issue！如果您有新的分割算法想法或界面优化建议，请随时提出。

## 📄 开源协议
本项目采用 [MIT License](LICENSE) 开源协议。
